{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="description" content="Vali is a responsive and free admin theme built with Bootstrap 5, SASS and PUG.js. It's fully customizable and modular.">
    <!-- Twitter meta-->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:site" content="@pratikborsadiya">
    <meta property="twitter:creator" content="@pratikborsadiya">
    <!-- Open Graph Meta-->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Vali Admin">
    <meta property="og:title" content="Vali - Free Bootstrap 5 admin theme">
    <meta property="og:url" content="http://pratikborsadiya.in/blog/vali-admin">
    <meta property="og:image" content="http://pratikborsadiya.in/blog/vali-admin/hero-social.png">
    <meta property="og:description" content="Vali is a responsive and free admin theme built with Bootstrap 5, SASS and PUG.js. It's fully customizable and modular.">
    <title>CEES</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Main CSS-->
    <!-- CSS Files -->
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    <!-- Font-icon css-->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <!-- jQuery UI CSS -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
</head>
<body class="app sidebar-mini">
    <!-- Navbar-->
    <header class="app-header"><a class="app-header__logo" href="index.html">FLN</a>
        <!-- Sidebar toggle button--><a class="app-sidebar__toggle" href="#" data-toggle="sidebar" aria-label="Hide Sidebar"></a>
        <!-- Navbar Right Menu-->
        <ul class="app-nav">
        <li class="app-search">
            <input class="app-search__input" type="search" placeholder="Search">
            <button class="app-search__button"><i class="bi bi-search"></i></button>
        </li>
        <!--Notification Menu-->
        <li class="dropdown"><a class="app-nav__item" href="#" data-bs-toggle="dropdown" aria-label="Show notifications"><i class="bi bi-bell fs-5"></i></a>
            <ul class="app-notification dropdown-menu dropdown-menu-right">
            <li class="app-notification__title">You have 4 new notifications.</li>
            <div class="app-notification__content">
                <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><i class="bi bi-envelope fs-4 text-primary"></i></span>
                    <div>
                    <p class="app-notification__message">Lisa sent you a mail</p>
                    <p class="app-notification__meta">2 min ago</p>
                    </div></a></li>
                <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><i class="bi bi-exclamation-triangle fs-4 text-warning"></i></span>
                    <div>
                    <p class="app-notification__message">Mail server not working</p>
                    <p class="app-notification__meta">5 min ago</p>
                    </div></a></li>
                <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><i class="bi bi-cash fs-4 text-success"></i></span>
                    <div>
                    <p class="app-notification__message">Transaction complete</p>
                    <p class="app-notification__meta">2 days ago</p>
                    </div></a></li>
                <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><i class="bi bi-envelope fs-4 text-primary"></i></span>
                    <div>
                    <p class="app-notification__message">Lisa sent you a mail</p>
                    <p class="app-notification__meta">2 min ago</p>
                    </div></a></li>
                <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><i class="bi bi-exclamation-triangle fs-4 text-warning"></i></span>
                    <div>
                    <p class="app-notification__message">Mail server not working</p>
                    <p class="app-notification__meta">5 min ago</p>
                    </div></a></li>
                <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><i class="bi bi-cash fs-4 text-success"></i></span>
                    <div>
                    <p class="app-notification__message">Transaction complete</p>
                    <p class="app-notification__meta">2 days ago</p>
                    </div></a></li>
            </div>
            <li class="app-notification__footer"><a href="#">See all notifications.</a></li>
            </ul>
        </li>
        <!-- User Menu-->
        <li class="dropdown"><a class="app-nav__item" href="#" data-bs-toggle="dropdown" aria-label="Open Profile Menu"><i class="bi bi-person fs-4"></i></a>
            <ul class="dropdown-menu settings-menu dropdown-menu-right">
            <li><a class="dropdown-item" href="page-user.html"><i class="bi bi-gear me-2 fs-5"></i> Settings</a></li>
            <li><a class="dropdown-item" href="page-user.html"><i class="bi bi-person me-2 fs-5"></i> Profile</a></li>
            <li><a class="dropdown-item" href="page-login.html"><i class="bi bi-box-arrow-right me-2 fs-5"></i> Logout</a></li>
            </ul>
        </li>
        </ul>
    </header>

    <!-- Sidebar menu-->
    <div class="app-sidebar__overlay" data-toggle="sidebar"></div>
    {% block sidebar %}
        {% include 'includes/sidebar.html' %}
    {% endblock sidebar %}
    <main class="app-content">
        <div class="app-title">
            <div>
                <h1><!-- <i class="bi bi-speedometer"></i> -->CEES - Contract Employee Evaluation System</h1>
                <!-- <p>{{ title }}</p> -->
            </div>
            <ul class="app-breadcrumb breadcrumb">
                <li class="breadcrumb-item"><i class="bi bi-house-door fs-6"></i></li>
                <li class="breadcrumb-item"><a href="#">{{ title }}</a></li>
            </ul>
        </div>
        {% block content %}{% endblock content %}
    </main>

    <!-- Essential javascripts for application to work-->
    <script src="{% static 'js/jquery-3.7.0.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>

    <!-- Datatables -->
    <link rel="stylesheet" href="https://cdn.datatables.net/v/bs5/dt-1.13.4/datatables.min.css">
    <script src="{% static 'js/plugins/datatables/datatables.min.js' %}"></script>
    <script >
        $(document).ready(function() {
            // Add Row
            $('#add-row').DataTable({
                columnDefs: [
                    {
                        targets: 0,        // Disable sorting for column 0
                        orderable: false   // Make the column unsortable
                    }
                ],
                order: [[1, 'asc']]
            });

            initDatepickers();
        });
    </script>

    <script>
        // Ketika baris yang dapat diklik
        $('#add-row tbody').on('click', 'td.clickable', function() {
            var td = $(this); // <td> yang diklik
            var tr = td.closest('tr'); // <tr> yang mengandung <td> yang diklik
            // var tr = $(this);
            var childRow = tr.next('.child-row');

            if (childRow.length) {
                // Jika baris anak sudah ada, toggle tampilannya
                childRow.toggle();
            } else {
                // Jika baris anak belum ada, buat dan tampilkan
                var childContent = '<tr class="child-row"><td colspan="5">';
                childContent += '<table class="table table-sm table-hover">';
                // Ambil data dari kolom yang disembunyikan
                tr.find('td').each(function(index) {
                    if (index > 0 && index < tr.find('td').length - 1) {
                        var columnName = $('#add-row th').eq(index).text();
                        var columnValue = $(this).text();
                        childContent += '<tr><td class="table-secondary"><strong>' + columnName + '</strong></td><td>' + columnValue + '</td></tr>';
                    }
                });
                childContent += '</table></td></tr>';
                tr.after(childContent); // Tambahkan baris anak setelah baris yang diklik
            }
        });
    </script>

    <script>
        // Hapus baris saat tombol "Delete" diklik
        $('#add-row tbody').on('click', '.deleteRow', function() {
            $(this).closest('tr').remove();
            // Perbarui nomor baris setelah menghapus
            // $('#add-row tbody tr').each(function(index) {
            //     $(this).find('td:nth-child(2)').text(index + 1);  // Update the second column (index 1) with the new row number
            // });
        });
    </script>

    <script>
        // Tambahkan baris saat tombol "Add Rows" diklik
        $('#addRows').on('click', function () {
            // Ambil jumlah baris yang diinput
            var rowCount = $('#rowCount').val();

            // Jika input kosong, tambahkan 1 baris
            if (rowCount === "") {
                rowCount = 1;
            }
            // Jika input bukan angka atau 0, jangan tambahkan baris
            else if (isNaN(rowCount) || rowCount <= 0) {
                alert('Input tidak valid! Masukkan angka lebih dari 0.');
                return;
            }

            // Loop untuk menambahkan baris sesuai jumlah yang diinput
            for (var i = 0; i < rowCount; i++) {
                // Buat baris baru
                var newRow = `
                    <tr>
                        <td></td>
                        <td></td>
                        {% for field in form %}
                            <td>{{ field }}</td>
                        {% endfor %}
                        <td class="align-middle">
                            <div class="bs-component">
                                <div class="btn-group" role="group" aria-label="Basic example">
                                    <div class="btn-group" role="group" aria-label="Basic example">
                                        <button type="button" class="btn btn-sm btn-danger deleteRow" title="Delete"><i class="bi bi-trash-fill"></i></button>
                                    </div>
                                </div>
                            </div>
                        </td> 
                    </tr>
                `;
                // Tambahkan baris ke "PALING ATAS" tabel
                $('#add-row tbody').prepend(newRow);
            }

            // Reset input jumlah baris
            $('#rowCount').val('');

            // Inisialisasi datepicker pada input baru
            initDatepickers();
        });
    </script>

    <!-- Checkbox -->
    <script>
        // Mendapatkan elemen checkbox "select semua" dan semua checkbox individual
        const checkAll = document.getElementById('check-all');
        const checkboxes = document.querySelectorAll('.select');
        const deleteButton = document.getElementById('delete-button');
        const deleteModalButton = document.getElementById('delete-modal-button');

        const form = document.querySelector('form');

        // Fungsi untuk menghapus atribut required
        function disableRequiredFields() {
            form.querySelectorAll('[required]').forEach(function (input) {
                input.removeAttribute('required');
            });
        }

        // Hanya tombol tertentu yang disable required
        deleteModalButton?.addEventListener('click', disableRequiredFields);
        
        // Fungsi untuk memeriksa apakah ada checkbox yang dicentang
        function toggleButtonVisibility() {
            // Cek apakah ada checkbox yang dicentang, jika iya tampilkan tombol
            const anyChecked = Array.from(checkboxes).some(checkbox => checkbox.checked) || checkAll.checked;
            if (!anyChecked) {
                deleteButton.classList.remove('btn-danger');
                deleteButton.classList.add('btn-secondary', 'disabled');
            } else {
                deleteButton.classList.remove('btn-secondary', 'disabled');
                deleteButton.classList.add('btn-danger');
            }

            /*
            if (!anyChecked) {
                deleteButton.classList.add('d-none');  // Sembunyikan tombol
            } else {
                deleteButton.classList.remove('d-none');  // Tampilkan tombol
            }*/
        }

        // Event listener untuk checkbox "select semua"
        checkAll.addEventListener('change', function() {
            // Setiap checkbox akan disesuaikan dengan status checkbox "select semua"
            checkboxes.forEach(function(checkbox) {
                checkbox.checked = checkAll.checked;
            });
            // Cek dan perbarui status tombol
            toggleButtonVisibility();
        });

        // Event listener untuk setiap checkbox individual
        checkboxes.forEach(function(checkbox) {
            checkbox.addEventListener('change', function() {
                // Jika ada checkbox yang tidak dicentang, hilangkan centang pada "select semua"
                if (!this.checked) {
                    checkAll.checked = false;
                } else {
                    // Cek apakah semua checkbox dicentang, jika iya centang "select semua"
                    checkAll.checked = Array.from(checkboxes).every(function(checkbox) {
                        return checkbox.checked;
                    });
                }
                // Cek dan perbarui status tombol
                toggleButtonVisibility();
            });
        });

        // Panggil fungsi pertama kali untuk memastikan tombol tersembunyi saat awal
        toggleButtonVisibility();
    </script>

    <!-- jQuery UI -->
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
    
    <!-- Datepicker -->
    <script>
        function initDatepickers() {
            // Inisialisasi untuk .bdatepicker
            $('.bdatepicker').not('.hasDatepicker').datepicker({
                dateFormat: 'dd-mm-yy',
                changeMonth: true,
                changeYear: true,
                yearRange: "1900:-17",
                maxDate: "-17Y"
            });

            // Inisialisasi untuk .datepicker
            $('.datepicker').not('.hasDatepicker').datepicker({
                dateFormat: 'dd-mm-yy',
                changeMonth: true,
                changeYear: true,
                yearRange: "c-10:c+1"
            });
        }
    </script>

    <!-- Page specific javascripts-->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script type="text/javascript">
        const salesData = {
        xAxis: {
            type: 'category',
            data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
        },
        yAxis: {
            type: 'value',
            axisLabel: {
                formatter: '${value}'
            }
        },
        series: [
            {
                data: [150, 230, 224, 218, 135, 147, 260],
                type: 'line',
                smooth: true
            }
        ],
        tooltip: {
            trigger: 'axis',
            formatter: "<b>{b0}:</b> ${c0}"
        }
        }
        
        const supportRequests = {
        tooltip: {
            trigger: 'item'
        },
        legend: {
            orient: 'vertical',
            left: 'left'
        },
        series: [
            {
                name: 'Support Requests',
                type: 'pie',
                radius: '50%',
                data: [
                    { value: 300, name: 'In Progress' },
                    { value: 50, name: 'Delayed' },
                    { value: 100, name: 'Complete' }
                ],
                emphasis: {
                    itemStyle: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }
        ]
        };
        
        const salesChartElement = document.getElementById('salesChart');
        const salesChart = echarts.init(salesChartElement, null, { renderer: 'svg' });
        salesChart.setOption(salesData);
        new ResizeObserver(() => salesChart.resize()).observe(salesChartElement);
        
        const supportChartElement = document.getElementById("supportRequestChart")
        const supportChart = echarts.init(supportChartElement, null, { renderer: 'svg' });
        supportChart.setOption(supportRequests);
        new ResizeObserver(() => supportChart.resize()).observe(supportChartElement);
    </script>

    <script>
        // Bootstrap 5 tooltip init
        const tooltipTriggerList = document.querySelectorAll('[title]');
        const tooltipList = [...tooltipTriggerList].map(el => new bootstrap.Tooltip(el));
    </script>
    <!-- Google analytics script -->
    <!-- <script type="text/javascript">
        if(document.location.hostname == 'pratikborsadiya.in') {
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-72504830-1', 'auto');
        ga('send', 'pageview');
        }
    </script> -->
</body>
</html>