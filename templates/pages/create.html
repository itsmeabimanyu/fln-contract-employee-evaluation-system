{% extends 'layouts/base.html' %}
{% load static custom_filters %}
<!-- [ Main Content ] start -->
{% block content %}

<div class="tile mb-4">
    <div class="page-header">
        <form method="post">
        {% csrf_token %}
            <div class="row">
                <div class="col-lg-12">
                    <h3 class="tile-title line-head">{{ card_title }}</h3>
                </div>
                <div class="table-responsive">
                    <table id="add-row" class="table table-sm table-hover" >
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="check-all" {% if not items %}disabled{% endif %}></th>
                                <th>#</th>
                                {% for field in form %}
                                    <th>{{ field.label }}</th>
                                {% endfor %}
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- ListView -->
                            {% for item in items %}
                            <tr>
                                <td><input type="checkbox" class="select" name="select" value="{{ item.id }}"></td>
                                <td class="clickable table-secondary">{{ forloop.counter }}</td>
                                {% for field in form %}
                                <td>{{ item|get_field_value:field.name|safe }}</td>
                                {% endfor %}
                                <td>
                                    <button type="button" class="btn w-100 btn-warning dropdown-toggle" data-bs-toggle="collapse" data-bs-target="#act-{{ item.id }}">Options </button>
                                    <div id="act-{{ item.id }}" class="collapse mt-1">
                                        {% for value in item.buttons_action %}
                                            {{ value|safe  }}
                                        {% endfor %}
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                            <!-- End ListView -->

                            <!-- Form -->
                            <tr>
                                <td></td>
                                <td>{% comment %}{{ items|length|add:1 }}{% endcomment %}</td>
                                {% for field in form %}
                                    <td>{{ field }}</td>
                                {% endfor %}
                                <td>
                                    <button type="button" class="btn btn-link deleteRow text-danger"><i class="fa fa-trash"></i></button>
                                </td> 
                            </tr>
                            <!-- End Form -->
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="tile-footer">
                <div class="row">
                    <div class="col-md-8 col-md-offset-3">
                        <button class="btn btn-primary" name="action" value="save" type="submit"><i class="bi bi-check-circle-fill me-2"></i>Submit</button>&nbsp;&nbsp;&nbsp;<button class="btn btn-secondary" type="button" onclick="window.history.back();"><i class="bi bi-x-circle-fill me-2"></i>Cancel</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
{% endblock content %}